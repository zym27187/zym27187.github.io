---
title: "关于本网站是如何建成的"
categories: "技术"
time: 2019-6-6 18:02:29
preview_text: 基于hexo下建立的gal主题博客
tags: ["建站","教程","hexo"]
---
[Node.js]: https://nodejs.org/zh-cn/ "下载Node.js"
[git]: https://git-scm.com/ "下载git"
[hexo]: https://hexo.io/zh-cn/docs/ "hexo官方说明文档"

## 技术汇总 ##
[Node.js][Node.js]
[git][git]
[hexo][hexo]
你可能需要了解:
[JavaScript](https://www.liaoxuefeng.com/wiki/1022910821149312 "教程")
[EJS模板](https://ejs.bootcss.com/ "JavaScript 模板引擎")

## Hexo初始化 ##
1.你需要下载[Node.js][Node.js]并安装,[安装配置教程](https://www.runoob.com/nodejs/nodejs-install-setup.html "菜鸟安装教程")。

2.你需要下载[git][git]并安装。
*   然后打开Git Bash，将你的Git与GitHub帐号绑定，依次输入指令：
    `git config --global user.name"你的GitHub用户名"`
    `git config --global user.email"你的GitHub注册邮箱"`
    生成你的密钥文件：
    `ssh-keygen -t rsa -C"你的GitHub注册邮箱"`
    然后直接三个回车即可，默认不需要设置密码

    然后找到生成的.ssh的文件夹中的id_rsa.pub密钥，将内容全部复制
    ![img2](https://i.loli.net/2019/06/10/5cfe0af619e8341838.png)
    打开[GitHub_Settings_keys](https://github.com/settings/keys)页面，新建new SSH Key
    ![img3](https://i.loli.net/2019/06/10/5cfe0e443141c45797.png)
    Title为标题，任意填即可，将刚刚复制的id_rsa.pub内容粘贴进去，最后点击Add SSH key。
    在Git Bash中检测GitHub公钥设置是否成功，输入 `ssh git@github.com`
    ![img4](https://i.loli.net/2019/06/10/5cfe1167ee29c89740.jpg)
    如上则说明成功。
    *   这里之所以设置GitHub密钥原因是，通过非对称加密的公钥与私钥来完成加密，公钥放置在GitHub上，私钥放置在自己的电脑里。GitHub要求每次推送代码都是合法用户，所以每次推送都需要输入账号密码验证推送用户是否是合法用户，**为了省去每次输入密码的步骤**，采用了ssh，当你推送的时候，git就会匹配你的私钥跟GitHub上面的公钥是否是配对的，若是匹配就认为你是合法用户，则允许推送。这样可以保证每次的推送都是正确合法的。
3.安装hexo,打开Git bash依次执行(**首先需要跳转到你本地的your-user-name.github.io文件夹目录**)

1.  `npm install -g hexo-cli`
2.  `hexo init <folder>`

    * 如果指定 \<folder\>，便会在目前的资料夹建立一个名为 \<folder\> 的新资料夹；否则会在目前资料夹初始化。
    
3.  `npm install`   安装依赖
4.  `hexo generate`  生成网站
5.  `hexo server`  启动本地服务器

    * 网站会执行在http://localhost:port （port 预设为 4000，可在**站点配置文件**_config.yml 中设定）

## 安装gal主题 ##
安装gal主题,参考[hexo-theme-gal](https://github.com/ZEROKISEKI/hexo-theme-gal)的步骤一步一步配置，或者可以自行选择其他你喜欢的hexo[主题](https://hexo.io/themes/)下载配置

这里主要讲一下几个坑点，
1.生成分类页和标签页的时候不仅要添加type还要添加layout，否则就是no found，具体请看[hexo 下的分类和表签无法显示，怎么解决？ - 虾哔哔的回答 - 知乎](https://www.zhihu.com/question/29017171/answer/364705653)
例如

    1       title: tags
    2       date: 2018-12-09 17:26:37
    3       type: tags
    4       layout: "tags"    
* layout指向gal主题里的layout文件夹路径
2.关于自定义页,需要在hexo站点目下运行:
`hexo new page about`
* 创建的页面在 站点根目录/sourse里配置
3.favicon.ico需要放到 站点根目录/sourse，碰到favicon没变的情况是缓存原因，常规清除浏览数据手段无效，需要手动去放置favicon缓存文件的位置删除，路径自行搜索

4.该主题的友情链接和个人链接设为false是不生效的，因为代码中没进行这样的判断，如不需要请自行找到/themes/gal/layout/_partial下的sidebar.js修改

5.评论系统使用的是gitment，听说不太好使，经常加载不出来，但是我用的海星。唯一的缺点是每篇文章第一次都要手动初始化一遍评论。配置评论系统的前置你已经部署好站点了，具体步骤根据[这个](https://github.com/ZEROKISEKI/hexo-theme-gal/wiki/%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E "评论系统配置说明")来
## GitHub创建个人仓库 ##
在部署到GitHubPages前，需要创建GitHub个人仓库

登录到GitHub,如果没有GitHub帐号，使用你的邮箱注册GitHub帐号：[Build software better, together](https://github.com/)点击GitHub中的New repository创建新仓库，仓库名应该为：用户名.github.io这个用户名使用你的GitHub帐号名称代替，这是固定写法，比如我的仓库名为：
![img1](https://i.loli.net/2019/06/10/5cfe03813b9c321306.png)
## 发布到 GitHubPages ##
发布之前首先要将Hexo与GitHub关联起来，打开**站点配置文件**_config.yml，翻到最后修改为：

    deploy:
    type: git
    repo: 这里填入你之前在GitHub上创建仓库的完整路径,记得加上.git
    branch: master  //分支为master
参考如下：
![img5](https://i.loli.net/2019/06/10/5cfe150c8bae929667.png)
* 其实就是给hexo d 这个命令做相应的配置，让hexo知道你要把blog部署在哪个位置
接下来分别输入三条命令：
`hexo clean`  清除站点缓存
`hexo g`  生成站点
`hexo d`  部署站点

#### &nbsp;&nbsp;&nbsp;&nbsp;然后你的站点就已经上线了，可以在网络上被访问了。后续有更改后需要重新执行三条命令部署站点 ####

## 关于网站源码备份##
最好的方式是在之前创建的个人仓库中新增一个分支，把源码备份上去

1.进入本地的your-user-name.github.io文件夹下
2.在本地新建一个分支： 
    `git branch hexo`
3.切换到你的新分支: 
    `git checkout hexo`
4.将新分支发布在github上：
    `git push origin hexo`
5.在github网站设置hexo为默认分支
1.  进入本地的your-user-name.github.io文件夹下
2.  `git clone https://github.com/your-user-name/your-user-name.github.io.git`
    此时显示分支为hexo
3.  `git add --all`
4.  `git commit -m "blog source commit"`
5.  `git push origin hexo`

#### &nbsp;&nbsp;&nbsp;&nbsp;至此博客源代码就备份到了hexo分支上面。 ####

## 域名绑定 ##
域名需要购买，过段时间有空再研究。

**tips:文章推荐用markdown来写，比较方便。[Markdown语法说明](https://www.appinn.com/markdown/#precode "简体中文")**